<section class="tab {{tab.cssClass}}" data-group="primary" data-tab="{{tab.id}}">
    <fieldset>
        <legend>{{localize "IMPMAL_COMMUNITY.DowntimeAction.Details"}}</legend>
        <div class="form-group">
            <label>{{localize "IMPMAL_COMMUNITY.DowntimeAction.AcquiredSL"}}</label>
            <div class="form-fields">
                <input type="number" name="system.acquiredSL" value="{{system.acquiredSL}}" step="1">
            </div>
        </div>
        <div class="form-group">
            <label>{{localize "IMPMAL_COMMUNITY.DowntimeAction.TypeLabel"}}</label>
            <div class="form-fields">
                <input type="text" name="system.downtimeType" value="{{system.downtimeType}}" list="downtime-action-types">
                <datalist id="downtime-action-types">
                    <option value="{{localize "IMPMAL_COMMUNITY.DowntimeAction.TypeOptions.Group"}}"></option>
                    <option value="{{localize "IMPMAL_COMMUNITY.DowntimeAction.TypeOptions.LongTerm"}}"></option>
                    <option value="{{localize "IMPMAL_COMMUNITY.DowntimeAction.TypeOptions.Individual"}}"></option>
                    <option value="{{localize "IMPMAL_COMMUNITY.DowntimeAction.TypeOptions.Custom"}}"></option>
                </datalist>
            </div>
        </div>
    </fieldset>

    <fieldset class="extended-test-list">
        <legend>{{localize "IMPMAL_COMMUNITY.DowntimeAction.Tests"}}</legend>
        <div class="form-group extended-test-add">
            <div class="form-fields">
                <button type="button" data-action="addDowntimeTest">
                    <i class="fa-solid fa-plus"></i> {{localize "IMPMAL_COMMUNITY.DowntimeAction.AddTest"}}
                </button>
            </div>
        </div>

        {{#each downtimeTests}}
        <div class="extended-test-row" data-test-index="{{@index}}">
            <input type="hidden" name="system.tests.{{@index}}.assignee.uuid" value="{{this.assignee.uuid}}">
            <input type="hidden" name="system.tests.{{@index}}.assignee.name" value="{{this.assignee.name}}">
            <input type="hidden" name="system.tests.{{@index}}.assignee.img" value="{{this.assignee.img}}">
            <div class="extended-test-header">
                <span class="extended-test-title">{{this.displayLabel}}</span>
                <button type="button" data-action="removeDowntimeTest" data-index="{{@index}}">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            <div class="form-group">
                <label>{{localize "IMPMAL.Characteristic"}}</label>
                <div class="form-fields">
                    <select name="system.tests.{{@index}}.characteristic" data-action="downtimeActionCharacteristic">
                        {{selectOptions (config "characteristics") selected=this.characteristic blank=""}}
                    </select>
                </div>
            </div>
            <div class="form-group" data-downtime-action-skill-row>
                <label>{{localize "IMPMAL.Skill"}}</label>
                <div class="form-fields">
                    <select name="system.tests.{{@index}}.skill.key" data-action="downtimeActionSkill">
                        {{selectOptions (config "skills") selected=this.skill.key blank=""}}
                    </select>
                    <input type="text" name="system.tests.{{@index}}.skill.specialisation" value="{{this.skill.specialisation}}" placeholder="{{localize 'IMPMAL.Specialisation'}}" data-action="downtimeActionSpecialisation">
                </div>
            </div>
            <div class="form-group">
                <label>{{localize "IMPMAL.Difficulty"}}</label>
                <div class="form-fields">
                    <select name="system.tests.{{@index}}.difficulty">
                        {{#select this.difficulty}}
                        {{#each (config "difficulties")}}
                        <option value="{{@key}}">{{this.name}} ({{numberFormat this.modifier sign=true}})</option>
                        {{/each}}
                        {{/select}}
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label>{{localize "IMPMAL.Modifier"}}</label>
                <div class="form-fields">
                    <input type="number" name="system.tests.{{@index}}.modifier" value="{{this.modifier}}">
                </div>
            </div>
            <div class="form-group">
                <label>{{localize "IMPMAL.SL"}} {{localize "IMPMAL.Modifier"}}</label>
                <div class="form-fields">
                    <input type="number" name="system.tests.{{@index}}.slModifier" value="{{this.slModifier}}">
                </div>
            </div>
            <div class="form-group">
                <label>{{localize "IMPMAL_COMMUNITY.DowntimeAction.State"}}</label>
                <div class="form-fields">
                    <select name="system.tests.{{@index}}.state">
                        {{#select this.state}}
                        <option value="normal">{{localize "IMPMAL.Normal"}}</option>
                        <option value="advantage">{{localize "IMPMAL.Advantage"}}</option>
                        <option value="disadvantage">{{localize "IMPMAL.Disadvantage"}}</option>
                        {{/select}}
                    </select>
                </div>
            </div>
        </div>
        {{/each}}
    </fieldset>
</section>
